## 3.1 OWASP 大语言模型十大风险解析

开放式 Web 应用安全项目（OWASP）发布的 LLM Top 10 是业界常用的 LLM 应用安全风险清单之一。

> 版本说明：本节基于 **OWASP Top 10 for LLM Applications 2025** 进行解读；后续版本请以 OWASP 官方页面为准（见附录 C-35）。

### 3.1.1 OWASP 与 LLM Top 10 背景

OWASP 是非营利安全社区组织，长期维护 Web 安全、API 安全与 AI 安全相关实践。  
LLM Top 10 的价值在于：把“模型风险”转译成“应用系统风险”，便于工程团队落地治理。

**2025 版风险条目（官方页面）**：

| 编号 | 风险名称（中文） | 英文原名 |
|------|------------------|----------|
| LLM01 | 提示注入 | Prompt Injection |
| LLM02 | 敏感信息泄露 | Sensitive Information Disclosure |
| LLM03 | 供应链风险 | Supply Chain |
| LLM04 | 数据与模型投毒 | Data and Model Poisoning |
| LLM05 | 输出处理不当 | Improper Output Handling |
| LLM06 | 过度自主权 | Excessive Agency |
| LLM07 | 系统提示泄露 | System Prompt Leakage |
| LLM08 | 向量与嵌入弱点 | Vector and Embedding Weaknesses |
| LLM09 | 错误信息 | Misinformation |
| LLM10 | 无边界消耗 | Unbounded Consumption |

> 与早期版本相比，部分条目在命名上更强调“应用层可控风险”，读者应关注风险内核，不要只记忆编号。

### 3.1.2 LLM01：提示注入（Prompt Injection）

**风险描述**：攻击者通过恶意指令影响模型执行路径，绕过系统规则。  
**典型场景**：直接注入、间接注入、工具返回注入。  
**防护重点**：
- 指令层与数据层分离
- 外部内容来源标记与降权
- 工具调用前置策略校验

### 3.1.3 LLM02：敏感信息泄露（Sensitive Information Disclosure）

**风险描述**：模型输出或上下文处理过程泄露隐私、密钥、系统细节或跨租户数据。  
**泄露路径**：训练记忆泄露、上下文回显、日志误采集、系统提示泄露。  
**防护重点**：
- 输入输出双向脱敏
- 多租户隔离与最小留存
- 敏感字段检测与审计告警

### 3.1.4 LLM03：供应链风险（Supply Chain）

**风险描述**：模型、数据集、依赖库、插件、镜像、推理服务任一环节被污染都可影响系统。  
**防护重点**：
- 来源可追溯（签名/校验）
- 依赖锁定与漏洞扫描
- SBOM 与变更审计

### 3.1.5 LLM04：数据与模型投毒（Data and Model Poisoning）

**风险描述**：攻击者污染训练/微调/检索数据或模型工件，诱导系统长期偏离预期行为。  
**防护重点**：
- 数据摄入白名单与分级审核
- 异常样本检测与回滚机制
- 模型版本基线与行为回归测试

### 3.1.6 LLM05：输出处理不当（Improper Output Handling）

**风险描述**：将 LLM 输出直接用于 SQL、Shell、模板渲染或 API 参数，触发传统安全漏洞。  
**防护重点**：
- 输出永不直连执行面
- 参数化调用与 schema 校验
- 高危操作二次确认

### 3.1.7 LLM06：过度自主权（Excessive Agency）

**风险描述**：Agent 被授予过多权限后，可能执行越权调用、批量外发或破坏性操作。  
**防护重点**：
- 最小权限与时效令牌
- 人在回路（HITL）审批
- 高风险工具硬性阻断策略

### 3.1.8 LLM07：系统提示泄露（System Prompt Leakage）

**风险描述**：攻击者诱导模型泄露系统提示、策略约束或内部流程信息。  
**防护重点**：
- 系统提示中不存放密钥
- 对“提示提取类”请求做专门过滤
- 用测试集持续回归“抗提取能力”

### 3.1.9 LLM08：向量与嵌入弱点（Vector and Embedding Weaknesses）

**风险描述**：RAG 场景下，嵌入、索引、检索与重排链路被操纵，导致错误或恶意上下文进入生成环节。  
**防护重点**：
- 向量库访问控制与加密
- 检索结果可信度评估
- 文档摄入阶段注入扫描

### 3.1.10 LLM09：错误信息（Misinformation）

**风险描述**：模型输出错误但看似可信的信息，在高敏场景可能造成现实损害。  
**防护重点**：
- 引用来源与事实核验
- 高风险域强制人工复核
- 不确定性提示与拒答策略

### 3.1.11 LLM10：无边界消耗（Unbounded Consumption）

**风险描述**：攻击者通过高并发、长上下文和高复杂度请求消耗预算与算力。  
**防护重点**：
- 速率限制与并发配额
- Token/步骤/工具调用上限
- 预算告警与自动熔断

OWASP LLM Top 10 的最佳使用方式不是“背诵条目”，而是把条目映射为可测试的安全控制项，并纳入日常工程评审与上线门禁。
